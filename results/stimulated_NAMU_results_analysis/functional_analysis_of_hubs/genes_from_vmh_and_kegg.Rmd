---
title: "R Notebook"
output: html_notebook
---

Automatic annotations
```{r}
path = "~/AA_PostDoc/human-metnet/"
#rxns  <- read_csv(paste0(path,"data/recon2_rxn_info.csv")) %>% column_to_rownames("X1")
genes <- read_csv(paste0(path,"data/recon2_genes_to_rxns.csv")) %>% column_to_rownames("X1") %>% set_rownames(NULL)

get_genes <- function(a_rxn){return(genes %>% filter(str_detect(Reactions, regex(a_rxn, ignore_case = T))) %>%
                            .[["Gene_ID"]] %>% str_trim %>% str_extract_all("^\\d+") %>% unlist())}



get_genes_by_centrality <- function(FC){
                                      centrality_to_genes <- function(centrality_names){FC[[centrality_names]]  %>% map(get_genes) %>% unlist %>% unique %>% return}
                                      FC %>% colnames() -> centrality_names
                                     centrality_names %>%  map(centrality_to_genes) %>% purrr::set_names(centrality_names) -> genes_by_centrality
                                     return(genes_by_centrality)}


genes$Reactions[2] %>% get_genes_by_centrality 

```


```{r message=FALSE, warning=FALSE}
setwd("~/AA_PostDoc/human-metnet/results/stimulated_NAMU_results_analysis/functional_analysis_of_hubs")
library(tidyverse)

extra_genes = data.frame(ID = c("3DPHBH2_Neuron", "NH3tm_Neuron", 'AASAD3m', "SPODMm", "COQ3m_Neuron", "H2Otm_Neuron", "Htm_Neuron") ,
                         KEGG_genes   =	c(NA, NA,501, 6648, 51805, 343, paste(9481, 7352, 7351, 7350, sep = ", ")),
                         VMH_gene_IDs = NA)
mas_genes <- read_csv("genes_q_faltan.csv")  %>%  select(c("ID","VMH_gene_IDs","KEGG_genes"))
genes <- read_csv('table_of_genes_from_VMH_KEGG.csv') %>% select(c("ID","VMH_gene_IDs","KEGG_genes")) %>% rbind(extra_genes) %>% rbind(mas_genes) 
#genes[1:8,"KEGG_genes"] = rep('1591', 8)

path_Hyperhubs.csv = "~/AA_PostDoc/human-metnet/results/stimulated_NAMU_results_analysis/Figure_4/Hyperhubs.csv"
path_Optimalhubs.csv = "~/AA_PostDoc/human-metnet/results/stimulated_NAMU_results_analysis/Figure_4/Optimalhubs.csv"
path_Centralhubs.csv = "~/AA_PostDoc/human-metnet/results/stimulated_NAMU_results_analysis/Figure_4/Centralhubs.csv"
optimalhubs <- read_csv(path_Optimalhubs.csv)
centralhubs <- read_csv(path_Centralhubs.csv)
hyperhubs <- read_csv(path_Hyperhubs.csv)

inner_join(optimalhubs, genes) %>% writexl::write_xlsx('optimalhubs.xlsx')
inner_join(centralhubs, genes)%>%writexl::write_xlsx('centralhubs.xlsx')
inner_join(hyperhubs, genes)%>%writexl::write_xlsx('hyperhubs.xlsx')
```










